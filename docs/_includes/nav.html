{% assign pages_list = site.html_pages | sort:"nav_order" %}
{% assign first_level_url = nil %}
{% assign second_level_url = nil %}

<ul class="navigation-list">
  <li class="navigation-list-item{% if page.url == '/' %} active{% endif %}">
    <a href="{{ '/' | absolute_url }}" class="navigation-list-link{% if page.url == '/' %} active{% endif %}">Home</a>
  </li>
  
  {%- for node in pages_list -%}
    {%- unless node.nav_exclude -%}
      {%- if node.parent == nil -%}
        {%- unless node.url == '/' -%}
          <li class="navigation-list-item{% if page.url == node.url %} active{% endif %}">
            <a href="{{ node.url | absolute_url }}" class="navigation-list-link{% if page.url == node.url %} active{% endif %}">{{ node.title }}</a>
            
            {%- if node.has_children -%}
              {%- assign children_list = pages_list | where: "parent", node.title -%}
              <ul class="navigation-list-child-list">
                {%- for child in children_list -%}
                  {%- unless child.nav_exclude -%}
                    <li class="navigation-list-item{% if page.url == child.url %} active{% endif %}">
                      <a href="{{ child.url | absolute_url }}" class="navigation-list-link{% if page.url == child.url %} active{% endif %}">{{ child.title }}</a>
                      
                      {%- if child.has_children -%}
                        {%- assign grand_children_list = pages_list | where: "parent", child.title -%}
                        <ul class="navigation-list-child-list">
                          {%- for grand_child in grand_children_list -%}
                            {%- unless grand_child.nav_exclude -%}
                              <li class="navigation-list-item{% if page.url == grand_child.url %} active{% endif %}">
                                <a href="{{ grand_child.url | absolute_url }}" class="navigation-list-link{% if page.url == grand_child.url %} active{% endif %}">{{ grand_child.title }}</a>
                              </li>
                            {%- endunless -%}
                          {%- endfor -%}
                        </ul>
                      {%- endif -%}
                    </li>
                  {%- endunless -%}
                {%- endfor -%}
              </ul>
            {%- endif -%}
          </li>
        {%- endunless -%}
      {%- endif -%}
    {%- endunless -%}
  {%- endfor -%}
</ul>